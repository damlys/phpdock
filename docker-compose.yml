version: "3.8"
x-common-app-config:
  &common-app-config
  build:
    context: .
    dockerfile: Dockerfile
  image: damlys/phpdock-app:0.0.0
  environment:
    HTTP_TESTS_ENDPOINT: http://http_server:8080

services:
  http_server:
    <<: *common-app-config

  example_job:
    <<: *common-app-config
    command:
      - php
      - bin/console.php
      - do-example-job
